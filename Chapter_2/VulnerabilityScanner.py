import nmap
import optparse


def nmapScan(host, port):
    nmScan = nmap.PortScanner()
    nmScan.scan(host, port)
    state = nmScan[host]['tcp'][int(port)]['state']
    print(' [*] %s tcp/%s %s' % (host, port, state))


def main():
    parser = optparse.OptionParser('usage%prog ' +\
                                   '-H <target host> -S <starting range> -F <finishing range>')
    parser.add_option('-H', dest='host', type='string',
                      help='specify target host')
    parser.add_option('-S', dest='start', type='string',
                      help='specify starting point')
    parser.add_option('-F', dest='finish', type='string',
                      help='specify finishing point')
    (options, args) = parser.parse_args()
    host = options.host
    s = int(options.start)
    f = int(options.finish)
    if (host == None) | (s == None) | (f == None):
        print(parser.usage)
        exit(0)
    for port in range(s, f, 1):
        nmapScan(host, str(port))


if __name__ == '__main__':
    main()